; Use directional arrow keys to move the blinking cursor

; Define blinking cursor character
CHR 2 0 0b11111111
CHR 2 1 0b10000001
CHR 2 2 0b10111101
CHR 2 3 0b10100101
CHR 2 4 0b10100101
CHR 2 5 0b10111101
CHR 2 6 0b10000001
CHR 2 7 0b11111111

; Define colors
PAL 0 0x000000
PAL 1 0x808080
PAL 2 0xffffff

CLS 0

; Declare variables
NUM key 0
NUM x 0
NUM y 0
NUM fgc 1
NUM ctr_blink 0

loop:
	OUT 2 x y fgc 0 0
	INP key
	CMP key $KB.UP
	CALL= key_up_handler
	CMP key $KB.DOWN
	CALL= key_down_handler
	CMP key $KB.RIGHT
	CALL= key_right_handler
	CMP key $KB.LEFT
	CALL= key_left_handler
	CMP key $KB.ESC
	CALL= reset
	INC ctr_blink
	CMP ctr_blink 1000
	JP!= loop
	SET ctr_blink 0
	INC fgc
	CMP fgc 3
	CALL= reset_fgc
	JP loop
	
reset_fgc:
	SET fgc 1
	RET
	
key_up_handler:
	DEC y
	CLS 0
	RET
key_down_handler:
	INC y
	CLS 0
	RET
key_right_handler:
	INC x
	CLS 0
	RET
key_left_handler:
	DEC x
	CLS 0
	RET

reset:
	RESET