
main:
	OUTM 1
	JP input_test
	JP palette_test
	JP charset_test

end:
	HALT

;======================================
;	Input Test
;======================================
input_test:
	INPM 1
	NUM key_up 1073741906
	NUM key_down 1073741905
	NUM key_left 1073741904
	NUM key_right 1073741903
	NUM key 0
	NUM x 0
	NUM y 0
input_test_loop:
	OUT 2 x y 15 0 0
	IN key
	CMP key key_up
	CALL= key_up_handler
	CMP key key_down
	CALL= key_down_handler
	CMP key key_right
	CALL= key_right_handler
	CMP key key_left
	CALL= key_left_handler
	JP input_test_loop
key_up_handler:
	ADD y -1
	CLS 0
	RET
key_down_handler:
	ADD y 1
	CLS 0
	RET
key_right_handler:
	ADD x 1
	CLS 0
	RET
key_left_handler:
	ADD x -1
	CLS 0
	RET

;======================================
;	Charset Test
;======================================
charset_test:
	OUTS "Charset Test" 0 0 10 0 0
	NUM c 0
	NUM x 0
	NUM y 2

charset_test_loop:
	OUT c x y 15 0 1
	ADD x 1
	ADD c 1
	CMP c 256
	JP= end
	CMP x 32
	JP!= charset_test_loop
	ADD y 1
	SET x 0
	JP charset_test_loop

;======================================
;	Palette Test
;======================================
palette_test:
	OUTS "Palette Test" 0 0 10 0 0
	NUM c 0
	NUM x 0
	NUM y 2

palette_test_loop:
	OUT 0 x y c c 1
	ADD x 1
	OUT 0 x y c c 1
	ADD c 1
	CMP c 256
	JP= end
	ADD x 1
	CMP x 32
	JP!= palette_test_loop
	ADD y 1
	SET x 0
	JP palette_test_loop
